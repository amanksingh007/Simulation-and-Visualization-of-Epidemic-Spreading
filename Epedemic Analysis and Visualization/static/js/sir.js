// =====================================. query selector =================================

header = document.querySelector("#heading");
start = document.querySelector("#start");
pie = document.querySelector("#pie");
result = document.querySelector("#result");


//=================================== Variables ==========================================

var map, heatmap,mvc , mcvR;
var numDeltas = 10;
var delay = 10; //milliseconds
var i =0;
var data;
var count1 = 0 ,count2 = 0;
var heatmap;

//   ============================= Color Changing Function =====================
function getRandomColor() {
  var letters = '0123456789ABCDEF';
  var color = '#';
  for (var i = 0; i < 6; i++) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}


function setColor()
{
	header.style.color = getRandomColor();
	result.style.color = getRandomColor();
  

}


setInterval(setColor,500);


// ===============================Map Event Listerner=============================================

start.addEventListener('click',initMap);


// ====================== Map Fuction ============================================================

function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {              // Creating an Instance of Google Map
          zoom: 4,								  // Zoom level of the Map
          center: {lat: 18.775, lng: -90.434},   // Centre of the Map
          mapTypeId: 'satellite'				// It will render the Satellite Version of Google Map on initial loading
        });


		mvc = new google.maps.MVCArray();	// This is a Dynamic Array which will contain co-ordinates to be plotted

           // ================== Infection heatmap =============================
        heatmap = new google.maps.visualization.HeatmapLayer({
                    data: mvc,        // Passing array of co-ordinates to be plotted on the Mao
                     map: map,		 // Passsing the Map Object
                     radius : 10	//

                    });


        move();

          

       }


   function move(){			/*It reads the point/co-ordinates/lat-lng from database generated by the simulation and pushes 
								to the MVC Array to Plot the	points on the heatMap*/
                  {% for k in range(i,i+50) %}

                  	{% if k < len(SIR) %}

                  		 var cur = new google.maps.LatLng({{SIR[k].lat}},{{SIR[k].lng}})  // Creating an Object of LatLng 
						 
                  		 mvc.push(cur);				// Pushing the new point to the MVC array

                  	{% endif %}

                  {% endfor %}
                         
                         i = k;
                         if (i < {{len(SIR)}})
                         {
		    	                        
                            count1 = i;
                            setTimeout(move,10);   // It calls move() function after each 10 mili-second.
                         
                         }
       }


         // =================================================== Map Function End ==================================

  // ============================================== Pie Chart Function ================================


	pie.addEventListener('click',function()
		{
				google.charts.setOnLoadCallback(drawChart);	
		});
 
      google.charts.load('current', {'packages':['corechart']});

       function drawChart() {



      var data = google.visualization.arrayToDataTable([
          ['No of people', 'Hours per Day'],        
          ['Saved', count2],
          ['Infected',     count1],

          ['Total',points.length]
          
        ]);

        var options = {
          title: 'Infection Activity'
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart')); // Creating pieChart object


        chart.draw(data, options);
        data.setValue(0, 1,count1);
        data.setValue(1, 1,count2);
        setInterval(drawChart,5000)
      }


// ==================================== Color changing of  recovery map =========================================


function changeGradient() {       //This function plots the points on the Map with colors as passed in Array:gradient
        var gradient = [
          'rgba(0, 0, 0, 0)',
          'rgba(0, 255, 255, 1)',
          'rgba(0, 191, 255, 1)',
          'rgba(0, 127, 255, 1)',
          'rgba(0, 63, 255, 1)',
          'rgba(0, 0, 255, 1)',
          'rgba(0, 0, 223, 1)',
          'rgba(0, 0, 191, 1)',
          'rgba(0, 0, 159, 1)',
          'rgba(0, 0, 127, 1)',
          'rgba(63, 0, 91, 1)',
          'rgba(127, 0, 63, 1)',
          'rgba(191, 0, 31, 1)',
          'rgba(0, 0, 0, 1)'
        ]
       
          heatmap.set('gradient', heatmap1.get('gradient') ? null : gradient); //Settingbthe gradient property of the heatMap

      }







